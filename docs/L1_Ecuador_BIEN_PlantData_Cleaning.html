<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2022-12-07" />

<title>Ecuador plant BIEN data cleaning</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.26/datatables.js"></script>
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">IBIO870_FinalProject</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="L0_BIEN_Ecuador_PlantData.html">L0</a>
</li>
<li>
  <a href="L1_Ecuador_BIEN_PlantData_Cleaning.html">L1</a>
</li>
<li>
  <a href="L2_Ecuador_plant_richness_analysis.html">L2</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/hazeljanderson/IBIO870_FinalProject">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Ecuador plant BIEN data cleaning</h1>
<h4 class="date">2022-12-07</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2022-12-11
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>IBIO870_FinalProject/</code>
<span class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.0). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20221207code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20221207)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20221207code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20221207)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomhazeljandersonIBIO870FinalProjecttree3877b2e085f62cc221bc8cce2cc267c15343d695targetblank3877b2ea">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/hazeljanderson/IBIO870_FinalProject/tree/3877b2e085f62cc221bc8cce2cc267c15343d695" target="_blank">3877b2e</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomhazeljandersonIBIO870FinalProjecttree3877b2e085f62cc221bc8cce2cc267c15343d695targetblank3877b2ea"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/hazeljanderson/IBIO870_FinalProject/tree/3877b2e085f62cc221bc8cce2cc267c15343d695" target="_blank">3877b2e</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    Output/
    Ignored:    Richness plot cleaned data.png
    Ignored:    Richness plot raw data.png

Untracked files:
    Untracked:  Workflow.png
    Untracked:  analysis/Workflow.png

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown
(<code>analysis/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd</code>) and HTML
(<code>docs/L1_Ecuador_BIEN_PlantData_Cleaning.html</code>) files. If
you’ve configured a remote Git repository (see
<code>?wflow_git_remote</code>), click on the hyperlinks in the table
below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/hazeljanderson/IBIO870_FinalProject/4104f465e2987e699f11d923c709162059f8af53/docs/L1_Ecuador_BIEN_PlantData_Cleaning.html" target="_blank">4104f46</a>
</td>
<td>
Hazel J. Anderson
</td>
<td>
2022-12-11
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/hazeljanderson/IBIO870_FinalProject/blob/5651451326525a1b07e32218bd14b3cfcfaab56f/analysis/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd" target="_blank">5651451</a>
</td>
<td>
Hazel J. Anderson
</td>
<td>
2022-12-11
</td>
<td>
update workflowr website
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/hazeljanderson/IBIO870_FinalProject/5651451326525a1b07e32218bd14b3cfcfaab56f/docs/L1_Ecuador_BIEN_PlantData_Cleaning.html" target="_blank">5651451</a>
</td>
<td>
Hazel J. Anderson
</td>
<td>
2022-12-11
</td>
<td>
update workflowr website
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/hazeljanderson/IBIO870_FinalProject/7760eea827b6f0a2252d73835c559c967ee3d73c/docs/L1_Ecuador_BIEN_PlantData_Cleaning.html" target="_blank">7760eea</a>
</td>
<td>
Hazel J. Anderson
</td>
<td>
2022-12-07
</td>
<td>
knit to html files
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/hazeljanderson/IBIO870_FinalProject/blob/e8899c5b6bb9989bb2b48e007f1faf0541f0d4f3/analysis/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd" target="_blank">e8899c5</a>
</td>
<td>
Hazel J. Anderson
</td>
<td>
2022-12-07
</td>
<td>
update name cleaning for knitting to html
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/hazeljanderson/IBIO870_FinalProject/blob/33226e1bbcda3cc1375984c1412646c656f8b1ce/analysis/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd" target="_blank">33226e1</a>
</td>
<td>
Hazel J. Anderson
</td>
<td>
2022-12-07
</td>
<td>
fix figure issue to print all figures in markdown and not save to file
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/hazeljanderson/IBIO870_FinalProject/blob/b6ccb7904cfb90c8dc707d69d2c6c42c92b35caa/analysis/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd" target="_blank">b6ccb79</a>
</td>
<td>
Hazel J. Anderson
</td>
<td>
2022-12-07
</td>
<td>
add data subsetting to simplifiy dataset by removing unnecessary columns
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/hazeljanderson/IBIO870_FinalProject/blob/5f91a6aa29e077bf91a83192526c1e1ec9483cbd/analysis/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd" target="_blank">5f91a6a</a>
</td>
<td>
Hazel J. Anderson
</td>
<td>
2022-12-07
</td>
<td>
convert file structure
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="set-file-paths" class="section level1">
<h1>Set file paths</h1>
<pre class="r"><code>data_path &lt;- file.path(&#39;G:/My Drive/IBIO 870/Final project/data/L0&#39;)
output_path &lt;- file.path(&#39;G:/My Drive/IBIO 870/Final project/data/L1&#39;)</code></pre>
</div>
<div id="load-required-packages" class="section level1">
<h1>Load required packages</h1>
<pre class="r"><code>library(bdc)
library(bdDwC)
library(bdvis)</code></pre>
</div>
<div id="read-in-bien-data" class="section level1">
<h1>Read in BIEN data</h1>
<pre class="r"><code>database &lt;- read.csv(file.path(data_path,&quot;Ecuador_BIEN_occurrence.csv&quot;))</code></pre>
</div>
<div id="configure-bien-data-to-darwin-core-standards"
class="section level1">
<h1>Configure BIEN data to Darwin Core Standards</h1>
<pre class="r"><code># darwinizing a dataset
config &lt;- read.csv(file.path(output_path,&quot;configuration table.csv&quot;))
print(config)</code></pre>
<pre><code>                       nameOld               nameNew  matchType
1               catalog_number         catalogNumber Darwinized
2              collection_code        collectionCode Darwinized
3                      country               country Darwinized
4                       county                county Darwinized
5  custodial_institution_codes       institutionCode Darwinized
6                    dataowner  ownerInstitutionCode Darwinized
7                      dataset           datasetName Darwinized
8                   datasource          collectionID Darwinized
9                datasource_id             datasetID Darwinized
10              date_collected     verbatimEventDate Darwinized
11             date_identified        dateIdentified Darwinized
12                 elevation_m     verbatimElevation Darwinized
13      identification_remarks identificationRemarks Darwinized
14               identified_by          identifiedBy Darwinized
15                    latitude       decimalLatitude Darwinized
16                    locality      verbatimLocality Darwinized
17                   longitude      decimalLongitude Darwinized
18            observation_type         basisOfRecord Darwinized
19               record_number          recordNumber Darwinized
20                 recorded_by            recordedBy Darwinized
21   scrubbed_taxonomic_status       taxonomicStatus Darwinized
22              state_province         stateProvince Darwinized
23             verbatim_family                family Darwinized
24    verbatim_scientific_name        scientificName Darwinized</code></pre>
<pre class="r"><code># rename dataset fields
database &lt;- renameUserData(database, config)</code></pre>
</div>
<div id="pre-filter" class="section level1">
<h1>Pre-filter</h1>
<p>Modified from <a
href="https://brunobrr.github.io/bdc/articles/prefilter.html"
class="uri">https://brunobrr.github.io/bdc/articles/prefilter.html</a></p>
<pre class="r"><code># Flag records missing species names
check_pf &lt;-
  bdc_scientificName_empty(
  data = database,
  sci_name = &quot;scientificName&quot;)</code></pre>
<pre><code>
bdc_scientificName_empty:
Flagged 0 records.
One column was added to the database.</code></pre>
<pre class="r"><code># Flag records missing partial or complete information on geographic coordinates
check_pf &lt;- bdc_coordinates_empty(
  data = check_pf,
  lat = &quot;decimalLatitude&quot;,
  lon = &quot;decimalLongitude&quot;)</code></pre>
<pre><code>
bdc_coordinates_empty:
Flagged 28540 records.
One column was added to the database.</code></pre>
<pre class="r"><code># Flag records with out-of-range coordinates: latitude &gt; 90 or -90; longitude &gt;180 or -180
check_pf &lt;- bdc_coordinates_outOfRange(
  data = check_pf,
  lat = &quot;decimalLatitude&quot;,
  lon = &quot;decimalLongitude&quot;)</code></pre>
<pre><code>
bdc_coordinates_outOfRange:
Flagged 0 records.
One column was added to the database.</code></pre>
<pre class="r"><code># Check record sources of your dataset using:
check_pf %&gt;%
  dplyr::group_by(basisOfRecord) %&gt;%
  dplyr::summarise(n = dplyr::n())</code></pre>
<pre><code># A tibble: 2 × 2
  basisOfRecord      n
  &lt;chr&gt;          &lt;int&gt;
1 plot            6383
2 specimen      297648</code></pre>
<pre class="r"><code>check_pf &lt;- bdc_basisOfRecords_notStandard(
  data = check_pf,
  basisOfRecord = &quot;basisOfRecord&quot;,
  names_to_keep = &quot;all&quot;)</code></pre>
<pre><code>
bdc_basisOfRecords_notStandard:
Flagged 6383 of the following specific nature:
 plot 
One column was added to the database.</code></pre>
<pre class="r"><code># Deriving country names for records missing country names
check_pf &lt;- bdc_country_from_coordinates(
  data = check_pf,
  lat = &quot;decimalLatitude&quot;,
  lon = &quot;decimalLongitude&quot;,
  country = &quot;country&quot;)</code></pre>
<pre><code>Loading required package: rnaturalearth</code></pre>
<pre><code>Loading required package: rnaturalearthdata</code></pre>
<pre><code>All records already had country information. Nothing was done!</code></pre>
<pre class="r"><code># Standardizing country names and getting country code information
check_pf &lt;- bdc_country_standardized(
  data = check_pf,
  country = &quot;country&quot;
)</code></pre>
<pre><code>Loading auxiliary data: country names from wikipedia</code></pre>
<pre><code>Loading auxiliary data: world map and country iso</code></pre>
<pre><code>Standardizing country names</code></pre>
<pre><code>country found: Ecuador</code></pre>
<pre><code>
bdc_country_standardized:
The country names of 0 records were standardized.
Two columns (&#39;country_suggested&#39; and &#39;countryCode&#39;) were added to the database.</code></pre>
<pre class="r"><code># Correcting latitude and longitude transposed
check_pf &lt;-
  bdc_coordinates_transposed(
    data = check_pf,
    id = &quot;collectionID&quot;,
    sci_names = &quot;scientificName&quot;,
    lat = &quot;decimalLatitude&quot;,
    lon = &quot;decimalLongitude&quot;,
    country = &quot;country_suggested&quot;,
    countryCode = &quot;countryCode&quot;,
    border_buffer = 0.2, # in decimal degrees (~22 km at the equator)
    save_outputs = FALSE
  )</code></pre>
<pre><code>Loading required package: readr</code></pre>
<pre><code>Correcting latitude and longitude transposed</code></pre>
<pre><code>4370 occurrences will be tested</code></pre>
<pre><code>Processing occurrences from: EC (4370)</code></pre>
<pre><code>
bdc_coordinates_transposed:
Corrected 300969 records.
One columns were added to the database.</code></pre>
<pre class="r"><code># Records outside one or multiple reference countries
check_pf &lt;-
  bdc_coordinates_country_inconsistent(
    data = check_pf,
    country_name = &quot;Ecuador&quot;,
    country = &quot;country_suggested&quot;,
    lon = &quot;decimalLongitude&quot;,
    lat = &quot;decimalLatitude&quot;,
    dist = 0.1 # in decimal degrees (~11 km at the equator)
  )</code></pre>
<pre><code>Spherical geometry (s2) switched off</code></pre>
<pre><code>dist is assumed to be in decimal degrees (arc_degrees).</code></pre>
<pre><code>although coordinates are longitude/latitude, st_intersection assumes that they
are planar</code></pre>
<pre><code>
bdc_coordinates_country_inconsistent:
Flagged 13 records.
One column was added to the database.</code></pre>
<pre class="r"><code># Report
check_pf &lt;- bdc_summary_col(data = check_pf)</code></pre>
<pre><code>
bdc_summary_col:
Flagged 34730 records.
One column was added to the database.</code></pre>
<pre class="r"><code>report &lt;-
  bdc_create_report(data = check_pf,
                    database_id = &quot;database_id&quot;,
                    workflow_step = &quot;prefilter&quot;,
                    save_report = FALSE)</code></pre>
<pre><code>Loading required package: DT</code></pre>
<pre class="r"><code>report</code></pre>
<div id="htmlwidget-e1e3757f040eaac33ef9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e1e3757f040eaac33ef9">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8"],["Records with empty scientific name","Records with empty coordinates","Records with coordinates out-of-range","Records from a doubtful source","Records outside one or multiple reference countries","Summary of all tests","","(*) calculated in relation to total number of records, i.e. 304031 records"],[".scientificName_empty",".coordinates_empty",".coordinates_outOfRange",".basisOfRecords_notStandard",".coordinates_country_inconsistent",".summary","",""],["0","28540","0","6383","13","34730","",""],["0","9.39","0","2.1","0","11.42","",""]],"container":"<table class=\"stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Description<\/th>\n      <th>Test_name<\/th>\n      <th>Records_flagged<\/th>\n      <th>perc_number_records(*)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"dom":"Brtip","scrollX":true,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># Figures
bdc_create_figures(data = check_pf,
                   database_id = &quot;database_id&quot;,
                   workflow_step = &quot;prefilter&quot;,
                   save_figures = FALSE)</code></pre>
<pre><code>Loading required package: cowplot</code></pre>
<pre><code>Loading required package: rworldmap</code></pre>
<pre><code>Loading required package: sp</code></pre>
<pre><code>### Welcome to rworldmap ###</code></pre>
<pre><code>For a short introduction type :      vignette(&#39;rworldmap&#39;)</code></pre>
<pre><code>Loading required package: ggplot2</code></pre>
<pre><code>Loading required package: hexbin</code></pre>
<pre><code>$.coordinates_empty</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.coordinates_country_inconsistent</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-14-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.summary</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-14-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$summary_all_tests</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-14-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.coordinates_country_inconsistent</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-14-5.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Filter out flags
database &lt;-
  check_pf %&gt;%
  dplyr::filter(.summary == TRUE) %&gt;%
  bdc_filter_out_flags(data = ., col_to_remove = &quot;all&quot;)</code></pre>
<pre><code>
bdc_fiter_out_flags:
The following columns were removed from the database:
.scientificName_empty, .coordinates_empty, .coordinates_outOfRange, .basisOfRecords_notStandard, .coordinates_country_inconsistent, .summary</code></pre>
</div>
<div id="flagging-common-time-issues" class="section level1">
<h1>Flagging common time issues</h1>
<p>Modified from <a
href="https://brunobrr.github.io/bdc/articles/time.html"
class="uri">https://brunobrr.github.io/bdc/articles/time.html</a></p>
<pre class="r"><code>check_time &lt;-
  bdc_eventDate_empty(data = database, eventDate = &quot;verbatimEventDate&quot;)</code></pre>
<pre><code>
bdc_eventDate_empty:
Flagged 24892 records.
One column was added to the database.</code></pre>
<pre class="r"><code>check_time &lt;-
  bdc_year_from_eventDate(data = check_time, eventDate = &quot;verbatimEventDate&quot;)</code></pre>
<pre><code>
bdc_year_from_eventDate:
Four-digit year were extracted from 244409 records.</code></pre>
<pre class="r"><code>check_time &lt;-
  bdc_year_outOfRange(data = check_time,
                      eventDate = &quot;year&quot;,
                      year_threshold = 1800)</code></pre>
<pre><code>
bdc_year_outOfRange:
Flagged 101 records.
One column was added to the database.</code></pre>
<pre class="r"><code>check_time &lt;- bdc_summary_col(data = check_time)</code></pre>
<pre><code>
bdc_summary_col:
Flagged 24993 records.
One column was added to the database.</code></pre>
<pre class="r"><code>report &lt;-
  bdc_create_report(data = check_time,
                    database_id = &quot;database_id&quot;,
                    workflow_step = &quot;time&quot;,
                    save_report = FALSE)

report</code></pre>
<div id="htmlwidget-fb4747baaa9ea3516f72" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-fb4747baaa9ea3516f72">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5"],["Records with empty eventDate","Records with year out-of-range (i.e., year in the future or\n                collected before a threshold defined by the user).","Summary of all tests","","(*) calculated in relation to total number of records, i.e. 269301 records"],[".eventDate_empty",".year_outOfRange",".summary","",""],["24892","101","24993","",""],["9.24","0.04","9.28","",""]],"container":"<table class=\"stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Description<\/th>\n      <th>Test_name<\/th>\n      <th>Records_flagged<\/th>\n      <th>perc_number_records(*)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"dom":"Brtip","scrollX":true,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>bdc_create_figures(data = check_time,
                   database_id = &quot;database_id&quot;,
                   workflow_step = &quot;time&quot;,
                   save_figures = FALSE)</code></pre>
<pre><code>$.eventDate_empty</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.year_outOfRange</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-21-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.summary</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-21-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$summary_all_tests</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-21-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$year</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-21-5.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>database &lt;-
  check_time %&gt;%
  dplyr::filter(.summary == TRUE) %&gt;%
  bdc_filter_out_flags(data = ., col_to_remove = &quot;all&quot;)</code></pre>
<pre><code>
bdc_fiter_out_flags:
The following columns were removed from the database:
.eventDate_empty, .year_outOfRange, .summary</code></pre>
</div>
<div id="flagging-common-spatial-issues" class="section level1">
<h1>Flagging common spatial issues</h1>
<p>Modified from <a
href="https://brunobrr.github.io/bdc/articles/space.html"
class="uri">https://brunobrr.github.io/bdc/articles/space.html</a></p>
<pre class="r"><code>check_space &lt;-
  bdc_coordinates_precision(
    data = database,
    lon = &quot;decimalLongitude&quot;,
    lat = &quot;decimalLatitude&quot;,
    ndec = c(0, 1) # number of decimals to be tested
  )</code></pre>
<pre><code>bdc_coordinates_precision:
Flagged 165 records
One column was added to the database.</code></pre>
<pre class="r"><code>check_space &lt;-
  CoordinateCleaner::clean_coordinates(
    x =  check_space,
    lon = &quot;decimalLongitude&quot;,
    lat = &quot;decimalLatitude&quot;,
    species = &quot;scientificName&quot;,
    countries = ,
    tests = c(
      &quot;capitals&quot;,     # records within 2km around country and province centroids
      &quot;centroids&quot;,    # records within 1km of capitals centroids
      &quot;duplicates&quot;,   # duplicated records
      &quot;equal&quot;,        # records with equal coordinates
      &quot;gbif&quot;,         # records within 1 degree (~111km) of GBIF headsquare
      &quot;institutions&quot;, # records within 100m of zoo and herbaria
      &quot;outliers&quot;,     # outliers
      &quot;zeros&quot;,        # records with coordinates 0,0
      &quot;urban&quot;         # records within urban areas
    ),
    capitals_rad = 2000,
    centroids_rad = 1000,
    centroids_detail = &quot;both&quot;, # test both country and province centroids
    inst_rad = 100, # remove zoo and herbaria within 100m
    outliers_method = &quot;quantile&quot;,
    outliers_mtp = 5,
    outliers_td = 1000,
    outliers_size = 10,
    range_rad = 0,
    zeros_rad = 0.5,
    capitals_ref = NULL,
    centroids_ref = NULL,
    country_ref = NULL,
    country_refcol = &quot;countryCode&quot;,
    inst_ref = NULL,
    range_ref = NULL,
    # seas_ref = continent_border,
    # seas_scale = 110,
    urban_ref = NULL,
    value = &quot;spatialvalid&quot; # result of tests are appended in separate columns
  )</code></pre>
<pre><code>Testing coordinate validity</code></pre>
<pre><code>Flagged 0 records.</code></pre>
<pre><code>Testing equal lat/lon</code></pre>
<pre><code>Flagged 0 records.</code></pre>
<pre><code>Testing zero coordinates</code></pre>
<pre><code>Flagged 0 records.</code></pre>
<pre><code>Testing country capitals</code></pre>
<pre><code>Flagged 0 records.</code></pre>
<pre><code>Testing country centroids</code></pre>
<pre><code>Flagged 1 records.</code></pre>
<pre><code>Testing urban areas</code></pre>
<pre><code>Downloading urban areas via rnaturalearth</code></pre>
<pre><code>OGR data source with driver: ESRI Shapefile 
Source: &quot;C:\Users\hj152\AppData\Local\Temp\Rtmpu8IOwb&quot;, layer: &quot;ne_50m_urban_areas&quot;
with 2143 features
It has 4 fields
Integer64 fields read as strings:  scalerank </code></pre>
<pre><code>Flagged 42 records.</code></pre>
<pre><code>Testing geographic outliers</code></pre>
<pre><code>Warning in cc_outl(otl_test, lon = lon, lat = lat, species = species, method =
outliers_method, : Species with fewer than 7 unique records will not be tested.</code></pre>
<pre><code>Flagged 449 records.</code></pre>
<pre><code>Testing GBIF headquarters, flagging records around Copenhagen</code></pre>
<pre><code>Flagged 0 records.</code></pre>
<pre><code>Testing biodiversity institutions</code></pre>
<pre><code>Flagged 0 records.</code></pre>
<pre><code>Testing duplicates</code></pre>
<pre><code>Flagged 212680 records.</code></pre>
<pre><code>Flagged 213068 of 244308 records, EQ = 0.87.</code></pre>
<pre class="r"><code>check_space &lt;- bdc_summary_col(data = check_space)</code></pre>
<pre><code>Column &#39;.summary&#39; already exist. It will be updated</code></pre>
<pre><code>
bdc_summary_col:
Flagged 213210 records.
One column was added to the database.</code></pre>
<pre class="r"><code>check_space %&gt;%
  dplyr::filter(.summary == FALSE) %&gt;% # map only records flagged as FALSE
  bdc_quickmap(
    data = .,
    lon = &quot;decimalLongitude&quot;,
    lat = &quot;decimalLatitude&quot;,
    col_to_map = &quot;.summary&quot;,
    size = 0.9
  )</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-25-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>report &lt;-
  bdc_create_report(data = check_space,
                    database_id = &quot;database_id&quot;,
                    workflow_step = &quot;space&quot;,
                    save_report = FALSE)

report</code></pre>
<div id="htmlwidget-e6ecdbcae10c15ec629c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e6ecdbcae10c15ec629c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12"],["Identical coordinates","Plain zeros","Records around country capital centroid","Records around country or province centroids","Geographical outliers","Records around the GBIF headquarters","Records around biodiversity institutions","Duplicated coordinates per species","Rounded (probably imprecise) coordinates","Records within urban areas","","(*) calculated in relation to total number of records, i.e. 244308 records"],[".equ",".zer",".cap",".cen",".otl",".gbf",".inst",".dpl",".rou",".urb","",""],["0","0","0","1","449","0","0","212680","165","42","",""],["0","0","0","0","0.18","0","0","87.05","0.07","0.02","",""]],"container":"<table class=\"stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Description<\/th>\n      <th>Test_name<\/th>\n      <th>Records_flagged<\/th>\n      <th>perc_number_records(*)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"dom":"Brtip","scrollX":true,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>bdc_create_figures(data = check_space,
                   database_id = &quot;database_id&quot;,
                   workflow_step = &quot;space&quot;,
                   save_figures = FALSE)</code></pre>
<pre><code>$.cen</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.otl</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-27-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.dpl</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-27-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.rou</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-27-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.urb</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-27-5.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.summary</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-27-6.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$summary_all_tests</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-27-7.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.cen</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-27-8.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.otl</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-27-9.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.dpl</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-27-10.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.rou</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-27-11.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>
$.urb</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-27-12.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>database &lt;-
  check_space %&gt;%
  dplyr::filter(.summary == TRUE) %&gt;%
  bdc_filter_out_flags(data = ., col_to_remove = &quot;all&quot;)</code></pre>
<pre><code>
bdc_fiter_out_flags:
The following columns were removed from the database:
.rou, .val, .equ, .zer, .cap, .cen, .urb, .otl, .gbf, .inst, .dpl, .summary</code></pre>
</div>
<div id="clean-and-parse-species-names" class="section level1">
<h1>Clean and parse species names</h1>
<p>Modified from <a
href="https://brunobrr.github.io/bdc/articles/taxonomy.html"
class="uri">https://brunobrr.github.io/bdc/articles/taxonomy.html</a></p>
<pre class="r"><code>parse_names &lt;-
  bdc_clean_names(sci_names = database$scientificName, save_outputs = FALSE)</code></pre>
<pre><code>
&gt;&gt; Family names prepended to scientific names were flagged and removed from 1 records.</code></pre>
<pre><code>&gt;&gt; Terms denoting taxonomic uncertainty were flagged and removed from 5 records.</code></pre>
<pre><code>&gt;&gt; Other issues, capitalizing the first letter of the generic name, replacing empty names by NA, and removing extra spaces, were flagged and corrected or removed from 4 records.</code></pre>
<pre><code>&gt;&gt; Infraspecific terms were flagged and removed from 1162 records.</code></pre>
<pre class="r"><code>parse_names &lt;-
  parse_names %&gt;%
  dplyr::select(.uncer_terms, names_clean)

database &lt;- dplyr::bind_cols(database, parse_names)</code></pre>
<pre class="r"><code>#not run for knit version - error with database
#query_names &lt;- bdc_query_names_taxadb(
#  sci_name            = database$names_clean,
#  replace_synonyms    = TRUE, # replace synonyms by accepted names?
#  suggest_names       = TRUE, # try to found a candidate name for misspelled names?
#  suggestion_distance = 0.9, # distance between the searched and suggested names
#  db                  = &quot;gbif&quot;, # taxonomic database
#  parallel            = TRUE, # should parallel processing be used?
#  ncores              = 8, # number of cores to be used in the parallelization process
#  export_accepted     = TRUE # save names linked to multiple accepted names
#)
#save(query_names, file = &quot;~analysis/query_names.Rdata&quot;)
load(file.path(output_path,&quot;query_names.Rdata&quot;))</code></pre>
<pre class="r"><code>database &lt;-
  database %&gt;%
  dplyr::rename(verbatim_scientificName = scientificName) %&gt;%
  dplyr::select(-names_clean) %&gt;%
  dplyr::bind_cols(., query_names)</code></pre>
<pre><code>New names:
• `family` -&gt; `family...3`
• `taxonomicStatus` -&gt; `taxonomicStatus...9`
• `taxonomicStatus` -&gt; `taxonomicStatus...46`
• `family` -&gt; `family...52`</code></pre>
<pre class="r"><code>report &lt;-
  bdc_create_report(data = database,
                    database_id = &quot;database_id&quot;,
                    workflow_step = &quot;taxonomy&quot;,
                    save_report = FALSE)

report</code></pre>
<div id="htmlwidget-304319757a80791af8d9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-304319757a80791af8d9">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["valid: name accepted","valid: synonym replaced by an accepted name","valid: accepted name that was misspelled","valid: accepted name assigned as misspelled synonym","check: ambiguous synonym linked to multiple accepted names","check: ambiguous synonym that was misspelled","check: ambiguous synonym linked to multiple accepted names","check: ambiguous synonym that was misspelled","invalid: name linked to multiple accepted names","invalid: name not found in the taxonomic database or a non\n                -interpretable name","synonym","invalid: no interpretable name","check: doubtful taxonomic identification","","(*) calculated in relation to total number of records, i.e. 31098 records"],["accepted","accepted | replaceSynonym","accepted | wasMisspelled","accepted | wasMisspelled | replaceSynonym","heterotypic synonym","heterotypic synonym | wasMisspelled","homotypic synonym","homotypic synonym | wasMisspelled","multipleAccepted","notFound","synonym","","taxo_uncer","",""],["25459","2308","238","40","139","1","1726","35","210","929","12","1","5","",""],["81.87","7.42","0.77","0.13","0.45","0","5.55","0.11","0.68","2.99","0.04","0","0.02","",""]],"container":"<table class=\"stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Description<\/th>\n      <th>notes<\/th>\n      <th>number_of_records<\/th>\n      <th>perc_number_records(*)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"dom":"Brtip","scrollX":true,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>unresolved_names &lt;-
  bdc_filter_out_names(data = database,
                       col_name = &quot;notes&quot;,
                       taxonomic_status = &quot;accepted&quot;,
                       opposite = TRUE)</code></pre>
<pre class="r"><code>output &lt;-
   bdc_filter_out_names(
     data = database,
     taxonomic_status = &quot;accepted&quot;,
     opposite = FALSE
   )</code></pre>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<pre class="r"><code>output &lt;- format_bdvis(output, Latitude = &quot;decimalLatitude&quot;, Longitude = &quot;decimalLongitude&quot;, Date_collected = &quot;verbatimEventDate&quot;, Scientific_name = &quot;scientificName&quot;)</code></pre>
<pre><code>Mapping via individual parameters</code></pre>
<pre><code>Changed &quot;decimalLatitude&quot; to &quot;Latitude&quot;</code></pre>
<pre><code>Changed &quot;decimalLongitude&quot; to &quot;Longitude&quot;</code></pre>
<pre><code>Changed &quot;verbatimEventDate&quot; to &quot;Date_collected&quot;</code></pre>
<pre><code>Changed &quot;scientificName&quot; to &quot;Scientific_name&quot;</code></pre>
<pre class="r"><code>bdsummary(output)</code></pre>
<pre><code>
 Total no of records = 28045 

 Temporal coverage... 
 Date range of the records from  0008-04-29  to  2018-04-15 

 Taxonomic coverage... 
 No of Families :  0 
 No of Genus :  0 
 No of Species :  11474 

 Spatial coverage ... 
 Bounding box of records  -4.79138889 , -80.917  -  1.38472 , -75.36639 
 Degree celles covered :  7 
 % degree cells covered :  23.3333333333333 </code></pre>
<pre class="r"><code>bdcalendarheat(output)</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-37-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>bdcomplete(output)</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-39-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>   Cell_id  nrec Sobs       Sest          c
1        1   130   94   252.0323 0.37296813
2        7    55   41   137.8381 0.29745042
3        8   116   97   348.4066 0.27841035
4       13    54   48   167.5833 0.28642466
5       14   117  108   584.1167 0.18489457
6       15    56   54   480.2143 0.11244980
7       19 10858 8595 21720.4291 0.39571041
8       20 12122 8895 17320.8846 0.51354190
9       21    72   51   148.9791 0.34232991
10      22   131   72   138.4637 0.51999188
11      25    84   67   298.7698 0.22425289
12      26   176   94   282.3618 0.33290627
13      27   113   71   150.4524 0.47191011
14      28  2702 2306 10027.6767 0.22996354
15      32   150  101   286.9169 0.35201835
16      38   107  105  1797.6333 0.05841013</code></pre>
<pre class="r"><code>distrigraph(output, ptype = &quot;species&quot;)</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-40-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>distrigraph(output, ptype = &quot;efforts&quot;)</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-40-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>distrigraph(output, ptype = &quot;cell&quot;)</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-40-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>distrigraph(output, ptype = &quot;effortspecies&quot;)</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-40-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>mapgrid(output, ptype = &quot;species&quot;, region = &quot;Ecuador&quot;)</code></pre>
<pre><code>Rendering map...plotting 29 tiles</code></pre>
<p><img src="figure/L1_Ecuador_BIEN_PlantData_Cleaning.Rmd/unnamed-chunk-41-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="subset-data-for-use-in-l2-analysis" class="section level1">
<h1>Subset data for use in L2 analysis</h1>
<pre class="r"><code># remove columns not needed for analysis
output &lt;- subset(output, select = c(&#39;Scientific_name&#39;, &quot;Latitude&quot;, &quot;Longitude&quot;, &quot;Date_collected&quot;, &quot;year&quot;, &quot;verbatimElevation&quot;))

# subset of data with elevation information
output_withElevation &lt;-subset(output, output$verbatimElevation != &quot;NA&quot;,)</code></pre>
</div>
<div id="save-output-data-to-csv" class="section level1">
<h1>Save output data to csv</h1>
<pre class="r"><code># Export the data into a CSV file
ecuador_BIEN_cleaned_path &lt;- file.path(output_path,&quot;Ecuador_BIEN_plant_cleaned.csv&quot;)
write.csv(output, file = ecuador_BIEN_cleaned_path)</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 22621)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.utf8 
[2] LC_CTYPE=English_United States.utf8   
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.utf8    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] RSQLite_2.2.19          hexbin_1.28.2           ggplot2_3.4.0          
 [4] rworldmap_1.3-6         sp_1.5-1                cowplot_1.1.1          
 [7] DT_0.26                 readr_2.1.3             rangeBuilder_2.0       
[10] countrycode_1.4.0       rnaturalearthdata_0.1.0 rnaturalearth_0.1.0    
[13] bdvis_0.2.33            bdDwC_0.1.15            bdc_1.1.2              
[16] workflowr_1.7.0        

loaded via a namespace (and not attached):
  [1] spam_2.9-1               uuid_1.1-0               igraph_1.3.5            
  [4] plyr_1.8.8               lazyeval_0.2.2           shinydashboard_0.7.2    
  [7] crosstalk_1.2.0          RApiSerialize_0.1.2      gridBase_0.4-7          
 [10] digest_0.6.30            foreach_1.5.2            htmltools_0.5.4         
 [13] viridis_0.6.2            fansi_1.0.3              magrittr_2.0.3          
 [16] memoise_2.0.1            tzdb_0.3.0               shinyFiles_0.9.3        
 [19] RcppParallel_5.1.5       vroom_1.6.0              askpass_1.1             
 [22] prettyunits_1.1.1        colorspace_2.0-3         treemap_2.4-3           
 [25] blob_1.2.3               xfun_0.35                dplyr_1.0.10            
 [28] rgdal_1.6-2              tcltk_4.2.2              callr_3.7.3             
 [31] crayon_1.5.2             jsonlite_1.8.4           stringfish_0.15.7       
 [34] zoo_1.8-11               iterators_1.0.14         ape_5.6-2               
 [37] glue_1.6.2               gtable_0.3.1             maps_3.4.1              
 [40] arkdb_0.0.16             scales_1.2.1             taxadb_0.1.6            
 [43] oai_0.4.0                contentid_0.0.16         DBI_1.1.3               
 [46] Rcpp_1.0.9               plotrix_3.8-2            viridisLite_0.4.1       
 [49] xtable_1.8-4             progress_1.2.2           units_0.8-1             
 [52] foreign_0.8-83           bit_4.0.5                bold_1.2.0              
 [55] proxy_0.4-27             dotCall64_1.0-2          rgbif_3.7.4             
 [58] sqldf_0.4-11             htmlwidgets_1.5.4        httr_1.4.4              
 [61] RColorBrewer_1.1-3       geosphere_1.5-18         ellipsis_0.3.2          
 [64] farver_2.1.1             pkgconfig_2.0.3          reshape_0.8.9           
 [67] sass_0.4.4               dbplyr_2.2.1             utf8_1.2.2              
 [70] here_1.0.1               conditionz_0.1.0         crul_1.3                
 [73] labeling_0.4.2           tidyselect_1.2.0         rlang_1.0.6             
 [76] later_1.3.0              munsell_0.5.0            tools_4.2.2             
 [79] cachem_1.0.6             cli_3.4.1                gsubfn_0.7              
 [82] generics_0.1.3           evaluate_0.18            shinyBS_0.61.1          
 [85] stringr_1.5.0            fastmap_1.1.0            yaml_2.3.6              
 [88] sys_3.4.1                processx_3.8.0           knitr_1.41              
 [91] bit64_4.0.5              fs_1.5.2                 purrr_0.3.5             
 [94] pbapply_1.6-0            nlme_3.1-160             whisker_0.4.1           
 [97] mime_0.12                taxize_0.9.100           xml2_1.3.3              
[100] compiler_4.2.2           rstudioapi_0.14          curl_4.3.3              
[103] e1071_1.7-12             tibble_3.1.8             bslib_0.4.1             
[106] stringi_1.7.8            highr_0.9                ps_1.7.2                
[109] fields_14.1              rgeos_0.5-9              lattice_0.20-45         
[112] rgnparser_0.2.5.91       rnaturalearthhires_0.2.0 classInt_0.4-8          
[115] shinyjs_2.1.0            vctrs_0.5.1              pillar_1.8.1            
[118] lifecycle_1.0.3          jquerylib_0.1.4          maptools_1.1-5          
[121] data.table_1.14.6        raster_3.6-11            httpuv_1.6.6            
[124] R6_2.5.1                 qs_0.25.4                promises_1.2.0.1        
[127] gridExtra_2.3            KernSmooth_2.23-20       codetools_0.2-18        
[130] assertthat_0.2.1         chron_2.3-58             proto_1.0.0             
[133] openssl_2.0.5            CoordinateCleaner_2.0-20 rprojroot_2.0.3         
[136] withr_2.5.0              httpcode_0.3.0           parallel_4.2.2          
[139] hms_1.1.2                terra_1.6-47             grid_4.2.2              
[142] class_7.3-20             rmarkdown_2.18           git2r_0.30.1            
[145] sf_1.0-9                 getPass_0.2-2            shiny_1.7.3             </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
